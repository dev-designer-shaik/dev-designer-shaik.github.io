<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>DSI Documentation ‚Äì Media Repository Architecture Guide</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header class="header">
        <div class="header__content">
            <div class="header__logo-container">
                <img src="logo.webp" alt="DSI Logo" class="header__logo">
                <button class="header__sidebar-toggle" id="sidebarToggle" aria-label="Toggle menu">Menu</button>
            </div>
            <div class="header__text">
                <h1 class="header__title">DSI IT Documentation</h1>
                <p class="header__subtitle">Media Repository Architecture & Workflow Guide</p>
            </div>
            <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">üåô</button>
        </div>
    </header>

    <nav class="sidebar-nav" id="sidebarNav">
        <div class="nav-header">
            <button class="nav-collapse-btn" id="navCollapseBtn" aria-label="Collapse navigation">
                <span class="nav-collapse-icon">‚óÄ</span>
            </button>
        </div>
        <ul class="nav-links">
            <li class="nav-section-header">Overview & Governance</li>
            <li><a href="#system-overview" data-section="system-overview">System Overview</a></li>
            <li><a href="#governance" data-section="governance">Governance & Compliance</a></li>
            
            <li class="nav-section-header">Architecture & Design</li>
            <li><a href="#system-architecture" data-section="system-architecture">System Architecture</a></li>
            <li><a href="#repository-structure" data-section="repository-structure">Repository Structure</a></li>
            <li><a href="#database-design" data-section="database-design">Database Design</a></li>
            
            <li class="nav-section-header">Workflow Management</li>
            <li><a href="#event-processing" data-section="event-processing">Event Processing Pipeline</a></li>
            <li><a href="#approval-workflows" data-section="approval-workflows">Approval Workflows</a></li>
            <li><a href="#media-processing" data-section="media-processing">Media Processing</a></li>
            
            <li class="nav-section-header">Integration & Services</li>
            <li><a href="#external-integrations" data-section="external-integrations">External Integrations</a></li>
            <li><a href="#ai-intelligence" data-section="ai-intelligence">AI & Intelligence</a></li>
            
            <li class="nav-section-header">Implementation & Operations</li>
            <li><a href="#deployment-guide" data-section="deployment-guide">Deployment Guide</a></li>
            <li><a href="#monitoring-testing" data-section="monitoring-testing">Monitoring & Testing</a></li>
        </ul>
    </nav>

    <main class="main-content" id="main-content">

        <section id="system-overview" class="content-section">
            <h2 class="content-section__title">System Overview</h2>
            <p>The DSI Media Repository Integration Architecture is a comprehensive, AI-powered digital asset management ecosystem that automates the complete lifecycle of luxury product media from initial design concepts through production-ready marketing assets. This unified system consolidates all media processing, approval workflows, and distribution channels into a single, intelligent platform.</p>

            <h3 class="content-section__subtitle">Core Architecture Overview</h3>
            <div class="mermaid-container2">
                <div class="mermaid">
graph TB
    subgraph DL["Data Layer"]
        GD["üóÇÔ∏è Google Drive<br>Primary Source"]
        QNAP["üíæ QNAP NAS<br>Local Backup"]
        S3["‚òÅÔ∏è AWS S3/GCS<br>Cold Storage"]
    end

    subgraph PL["Processing Layer"]
        N8N["‚öôÔ∏è n8n<br>Workflow Engine"]
        OAI["ü§ñ OpenAI<br>AI Analysis"]
        PS["üì° Google Pub/Sub<br>Event Transport"]
        MA["üéØ Manus/Abacus<br>AI Agents"]
    end

    subgraph ST["Storage"]
        WV["üîç Weaviate<br>Vector Search"]
        PG["üóÑÔ∏è PostgreSQL<br>Metadata & Logs"]
    end
    
    subgraph DT["Distribution"]
        CDN["üåê Cloudinary<br>Media Optimization"]
        VJ["üìπ Vidjet<br>Video Hosting"]
        GC["üí¨ Google Chat<br>Notifications"]
    end
    
    subgraph BS["Business Systems"]
        ERP["üìä ERPNext<br>Product Management"]
        WC["üõí WooCommerce<br>eCommerce"]
        WF["üé® Webflow<br>Marketing"]
    end

    GD --> PS
    PS --> N8N
    N8N --> MA
    N8N --> OAI
    OAI --> WV
    N8N --> PG
    N8N --> CDN
    WV --> ERP
    CDN --> WC
    CDN --> WF
                </div>
            </div>

            <h3 class="content-section__subtitle">Technology Stack Matrix</h3>
            <table class="data-table">
                <thead>
                    <tr>
                        <th scope="col">Category</th>
                        <th scope="col">Technology</th>
                        <th scope="col">Primary Function</th>
                        <th scope="col">Integration Points</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td data-label="Category">Source Control</td><td data-label="Technology">Google Drive</td><td data-label="Primary Function">Primary media repository</td><td data-label="Integration Points">n8n triggers, AI processing</td></tr>
                    <tr><td data-label="Category">Message Broker</td><td data-label="Technology">RabbitMQ</td><td data-label="Primary Function">Event-driven workflow orchestration</td><td data-label="Integration Points">Queue management, workflow triggers</td></tr>
                    <tr><td data-label="Category">Orchestration</td><td data-label="Technology">n8n</td><td data-label="Primary Function">Workflow automation engine</td><td data-label="Integration Points">All systems integration hub</td></tr>
                    <tr><td data-label="Category">Vector Database</td><td data-label="Technology">Weaviate</td><td data-label="Primary Function">AI-powered semantic search</td><td data-label="Integration Points">OpenAI embeddings, metadata</td></tr>
                    <tr><td data-label="Category">Relational DB</td><td data-label="Technology">PostgreSQL</td><td data-label="Primary Function">Structured metadata storage</td><td data-label="Integration Points">Audit logs, processing status</td></tr>
                    <tr><td data-label="Category">AI Processing</td><td data-label="Technology">OpenAI</td><td data-label="Primary Function">Content analysis & tagging</td><td data-label="Integration Points">Weaviate vectors, metadata</td></tr>
                    <tr><td data-label="Category">CDN & Optimization</td><td data-label="Technology">Cloudinary</td><td data-label="Primary Function">Media transformation & delivery</td><td data-label="Integration Points">URL generation, format optimization</td></tr>
                    <tr><td data-label="Category">ERP</td><td data-label="Technology">ERPNext</td><td data-label="Primary Function">Product & inventory management</td><td data-label="Integration Points">SKU, pricing, BOM tracking</td></tr>
                    <tr><td data-label="Category">eCommerce</td><td data-label="Technology">WooCommerce</td><td data-label="Primary Function">Online product sales</td><td data-label="Integration Points">Product listings, media sync</td></tr>
                    <tr><td data-label="Category">Marketing</td><td data-label="Technology">Webflow</td><td data-label="Primary Function">Marketing websites</td><td data-label="Integration Points">Content management, CDN</td></tr>
                </tbody>
            </table>

            <h3 class="content-section__subtitle">Automation Capabilities Matrix</h3>
            <table class="data-table">
                <thead>
                    <tr>
                        <th scope="col">Function Area</th>
                        <th scope="col">Tool / Agent</th>
                        <th scope="col">Automation Level</th>
                        <th scope="col">Key Use Case</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td data-label="Function Area">Media Ingestion</td><td data-label="Tool / Agent">n8n + RabbitMQ</td><td data-label="Automation Level">Fully Automated</td><td data-label="Key Use Case">Google Drive to processing pipeline</td></tr>
                    <tr><td data-label="Function Area">AI Tagging</td><td data-label="Tool / Agent">OpenAI + Weaviate</td><td data-label="Automation Level">Fully Automated</td><td data-label="Key Use Case">Automatic metadata generation</td></tr>
                    <tr><td data-label="Function Area">Approval Management</td><td data-label="Tool / Agent">Multi-channel Approval</td><td data-label="Automation Level">Semi-Automated</td><td data-label="Key Use Case">Chat, Sheets, Forms integration</td></tr>
                    <tr><td data-label="Function Area">CDN Optimization</td><td data-label="Tool / Agent">Cloudinary</td><td data-label="Automation Level">Fully Automated</td><td data-label="Key Use Case">Format conversion & delivery</td></tr>
                    <tr><td data-label="Function Area">ERP Integration</td><td data-label="Tool / Agent">n8n Scheduled Sync</td><td data-label="Automation Level">Fully Automated</td><td data-label="Key Use Case">Product data synchronization</td></tr>
                    <tr><td data-label="Function Area">Document Processing</td><td data-label="Tool / Agent">Dual OCR Engine</td><td data-label="Automation Level">Fully Automated</td><td data-label="Key Use Case">Text extraction & indexing</td></tr>
                    <tr><td data-label="Function Area">Quality Control</td><td data-label="Tool / Agent">AI Quality Assessment</td><td data-label="Automation Level">Fully Automated</td><td data-label="Key Use Case">Automated quality scoring</td></tr>
                    <tr><td data-label="Function Area">Publication</td><td data-label="Tool / Agent">Multi-platform Sync</td><td data-label="Automation Level">Fully Automated</td><td data-label="Key Use Case">Cross-platform distribution</td></tr>
                </tbody>
            </table>
        </section>

        <section id="governance" class="content-section">
            <h2 class="content-section__title">Governance & Compliance</h2>
            
            <h3 class="content-section__subtitle">IP Hierarchy</h3>
            <div class="mermaid-container7">
                <div class="mermaid">
%%{init: {
  "theme": "base",
  "themeCSS": ".edgePath marker path { fill: #808080 !important; stroke: #536277 !important; }\n.marker { fill: #808080 !important; }\n.text-item-align { fill: #808080 !important; }\n.subgraph .title { fill: #808080 !important; }"
}}%%
graph TB
    MH["Marayai Holdings<br>Parent Company"]
    SF["Shaikdom Foundation<br>Non-Profit Arm"]
    DSS["Designer Shaik Studio<br>Creative Unit"]
    DSI["DSI Product Repository<br>Content Hub"]
    
    MH --> SF
    MH --> DSS
    DSS --> DSI
    SF --> DSI
                </div>
            </div>

            <h3 class="content-section__subtitle">Digital Asset Ownership</h3>
            <p>All digital assets created or acquired by any entity within the Marayai ecosystem are ultimately owned by Marayai Holdings. Usage rights, licensing, and distribution are governed by specific protocols outlined in this guide. The system maintains comprehensive audit trails for all asset modifications, approvals, and distributions to ensure compliance with intellectual property regulations.</p>
            
            <h3 class="content-section__subtitle">Compliance Framework</h3>
            <p>The architecture adheres to regional data privacy laws including GDPR and ADGM regulations. All processing activities are logged in PostgreSQL with immutable audit trails. Regular compliance audits are conducted through automated reporting systems integrated with the workflow engine.</p>

            <h3 class="content-section__subtitle">Data Governance Policies</h3>
            <table class="data-table">
                <thead>
                    <tr>
                        <th scope="col">Data Category</th>
                        <th scope="col">Retention Policy</th>
                        <th scope="col">Access Control</th>
                        <th scope="col">Backup Strategy</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td data-label="Data Category">Product Media</td><td data-label="Retention Policy">Permanent</td><td data-label="Access Control">Role-based (Design Team)</td><td data-label="Backup Strategy">Multi-tier (Drive, NAS, Cloud)</td></tr>
                    <tr><td data-label="Data Category">Processing Logs</td><td data-label="Retention Policy">7 years</td><td data-label="Access Control">IT Admin only</td><td data-label="Backup Strategy">PostgreSQL automated backup</td></tr>
                    <tr><td data-label="Data Category">Approval Records</td><td data-label="Retention Policy">Permanent</td><td data-label="Access Control">Management + Legal</td><td data-label="Backup Strategy">Immutable audit trail</td></tr>
                    <tr><td data-label="Data Category">AI Metadata</td><td data-label="Retention Policy">Linked to source asset</td><td data-label="Access Control">System automated</td><td data-label="Backup Strategy">Weaviate cluster backup</td></tr>
                </tbody>
            </table>
        </section>

        <section id="system-architecture" class="content-section">
            <h2 class="content-section__title">System Architecture</h2>
            
            <h3 class="content-section__subtitle">Core Components</h3>
            <div class="mermaid-container5">
                <div class="mermaid">
%%{init: {
  "theme": "base",
  "themeCSS": ".edgePath marker path { fill: #808080 !important; stroke: #536277 !important; }\n.marker { fill: #808080 !important; }\n.text-item-align { fill: #808080 !important; }\n.subgraph .title { fill: #808080 !important; }"
}}%%
graph TB
    subgraph Input["Data Input Layer"]
        GD["Google Drive<br>Primary Repository"]
        PS["Google Pub/Sub<br>Event Stream"]
        CF["Cloud Function<br>Webhook Handler"]
        RMQ["RabbitMQ<br>Message Broker"]
    end

    subgraph Processing["Processing Layer"]
        N8N["n8n<br>Workflow Engine"]
        OAI["OpenAI API<br>Vision & Analysis"]
        OCR["Dual OCR<br>Textract + Vision"]
    end

    subgraph Storage["Storage Layer"]
        PG["PostgreSQL<br>Metadata & Logs"]
        WV["Weaviate<br>Vector Database"]
        CDN["Cloudinary<br>Media CDN"]
    end

    subgraph Distribution["Distribution Layer"]
        ERP["ERPNext<br>Product Data"]
        WC["WooCommerce<br>eCommerce"]
        WF["Webflow<br>Marketing Sites"]
    end

    GD --> PS
    PS --> CF
    CF --> RMQ
    RMQ --> N8N
    N8N --> OAI
    N8N --> OCR
    N8N --> PG
    OAI --> WV
    N8N --> CDN
    CDN --> ERP
    CDN --> WC
    CDN --> WF
                </div>
            </div>

            <h3 class="content-section__subtitle">Data Flow Architecture</h3>
            <p>The system implements a sophisticated event-driven architecture where Google Drive serves as the primary source of truth. File changes trigger webhook notifications that flow through Google Pub/Sub to Cloud Functions, which then publish structured messages to RabbitMQ queues. This design ensures reliable message delivery and enables sophisticated routing based on file types and processing requirements.</p>

            <h3 class="content-section__subtitle">Processing Pipeline</h3>
            <pre class="code-block">
1. File Upload ‚Üí Google Drive
2. Drive API ‚Üí Webhook Notification  
3. Cloud Function ‚Üí Pub/Sub Message
4. RabbitMQ ‚Üí Queue Routing
5. n8n Trigger ‚Üí Workflow Execution
6. AI Processing ‚Üí Metadata Extraction
7. Database Storage ‚Üí PostgreSQL + Weaviate
8. CDN Optimization ‚Üí Cloudinary
9. System Sync ‚Üí ERPNext, WooCommerce, Webflow
            </pre>

            <h3 class="content-section__subtitle">Scalability Considerations</h3>
            <p>The architecture is designed for horizontal scaling with RabbitMQ clustering for high availability message processing, PostgreSQL read replicas for query performance, and Weaviate distributed deployment for vector search scalability. Cloudinary provides global CDN distribution with automatic scaling based on demand.</p>
        </section>

        <section id="repository-structure" class="content-section">
            <h2 class="content-section__title">Repository Structure</h2>
            
            <h3 class="content-section__subtitle">Repository Folder Structure</h3>
            <div class="diagram-split">
                <div class="diagram-part">
                    <h4>System Structure</h4>
                    <div class="mermaid-container2">
                        <div class="mermaid">
%%{init: {
  "theme": "base",
  "themeCSS": ".edgePath marker path { fill: #808080 !important; stroke: #536277 !important; }\n.marker { fill: #808080 !important; }\n.text-item-align { fill: #808080 !important; }\n.subgraph .title { fill: #808080 !important; }"
}}%%
graph TB
    Root["üìÅ DSI-Product-Repository"]
    
    subgraph SF["System Folders"]
        Meta["üìã Metadata"]
        Proc["‚ö° Processed-Media"]
    end
    
    subgraph MS["Metadata Structure"]
        Tag["üè∑Ô∏è Tagging-Data"]
        AI["ü§ñ AI-Generated-Tags"]
        Multi["üåê Multilingual-Descriptions"]
        Ver["üìù Version-Control"]
        Change["üìä Media-Change-History"]
        Approval["‚úÖ Approval-Stages"]
        MCP["üîó MCP-Context"]
    end
    
    Root --> SF
    Meta --> MS
                        </div>
                    </div>
                </div>
                
                <div class="diagram-part">
                    <h4>Product Structure</h4>
                    <div class="mermaid-container1">
                        <div class="mermaid">
%%{init: {
  "theme": "base",
  "themeCSS": ".edgePath marker path { fill: #808080 !important; stroke: #536277 !important; }\n.marker { fill: #808080 !important; }\n.text-item-align { fill: #808080 !important; }\n.subgraph .title { fill: #808080 !important; }"
}}%%
graph TB
    subgraph PP["Product Palaces"]
        PF["üå∏ Palace-of-Fragrances"]
        PPR["‚öôÔ∏è Palace-of-Precision"]
        PS["üëî Palace-of-Style"]
    end
    
    subgraph POF["Palace of Fragrances"]
        Precious["üíé Precious-Range"]
        Classic["üèõÔ∏è Classic-Range"]
    end
    
    subgraph PR["Precious Range"]
        OptimumGold["ü•á Objet-d-Art-Optimum<br>Precious-Gold"]
        SterlinSilver["ü•à Objet-d-Art-Luxury<br>Sterling-Silver"]
    end
    
    subgraph CR["Classic Range"]
        Amethyst["üíú Opulent-Shaik<br>Amethyst"]
        Sapphire["üíô Opulent-Shaik<br>Sapphire"]
        Emerald["üíö Chic-Shaik<br>Emerald"]
        Onyx["üñ§ Sochi-Onyx"]
        Amber["üß° Amber-Kroud"]
    end
    
    PF --> POF
    Precious --> PR
    Classic --> CR
                        </div>
                    </div>
                </div>
            </div>

            <h3 class="content-section__subtitle">Google Drive Hierarchy</h3>
            <pre class="code-block">
[SANDBOX] DSI 06 - Media Repository/
‚îú‚îÄ‚îÄ DSI-Product-Repository/
‚îÇ   ‚îú‚îÄ‚îÄ Palace-of-Fragrances/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Classic-Range/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Opulent-Shaik-Amethyst/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 00-Early-Design/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 01-Research/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 02-Concept-Sketches/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 03-Concept-CAD/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 04-Design-Review/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ 05-Prototype-Assets/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Media/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Images/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 3D-Renders/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Photos/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Web-Optimized/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Videos/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Marketing/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ERP-Integration/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Chic-Shaik-Emerald/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Amber-Kroud/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Opulent-Shaik-Sapphire/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Sochi-Onyx/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Precious-Range/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ Objet-d-Art-Luxury-Sterling-Silver/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ Objet-d-Art-Optimum-Precious-Gold/
‚îÇ   ‚îú‚îÄ‚îÄ Palace-of-Precision/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ AstroTime-MK1/
‚îÇ   ‚îî‚îÄ‚îÄ Palace-of-Style/
‚îî‚îÄ‚îÄ Processed-Media/
    ‚îú‚îÄ‚îÄ ERP-Integrated/
    ‚îú‚îÄ‚îÄ Marketing/
    ‚îî‚îÄ‚îÄ Web-Optimized/
            </pre>

            <h3 class="content-section__subtitle">File Naming Convention</h3>
            <div class="highlight-box">
                <strong>Pattern:</strong> <code>{ProductName}_{SKU}_{descriptor}_{timestamp}.{extension}</code>
                <ul>
                    <li><code>Opulent-Shaik-Amethyst_OSA-GE-100_hero_20250703.jpg</code></li>
                    <li><code>AstroTime-MK1_ATM-IG-001_3d_render.blend</code></li>
                    <li><code>Objet-d-Art-Optimum_OAO-FL-50_metadata.json</code></li>
                </ul>
            </div>

            <h3 class="content-section__subtitle">MCP Protocol Integration</h3>
            <p>The Model Context Protocol (MCP) provides standardized metadata management across all assets. Each file receives an MCP ID following the pattern <code>[ProductName]_[Version]_[Status]_[Timestamp]</code>, enabling intelligent version control and context tracking throughout the processing pipeline.</p>
        </section>

        <section id="database-design" class="content-section">
            <h2 class="content-section__title">Database Design</h2>

            <h3 class="content-section__subtitle">PostgreSQL Schema Visualization</h3>
            <div class="mermaid-container">
                <div class="mermaid" id="media-assets-er-diagram">
erDiagram
    media_assets {
        SERIAL id PK
        VARCHAR drive_file_id UK
        UUID weaviate_object_id
        VARCHAR mcp_id
        VARCHAR product_name
        VARCHAR sku
        VARCHAR file_name
        BIGINT file_size
        VARCHAR mime_type
        TEXT drive_folder_path
        TEXT cloudinary_url
        VARCHAR processing_status
        TEXT ai_description
        TEXT ai_tags
        TIMESTAMP created_at
        TIMESTAMP updated_at
    }

    processing_logs {
        SERIAL id PK
        INTEGER media_asset_id FK
        VARCHAR workflow_id
        VARCHAR step_name
        VARCHAR status
        TEXT message
        TIMESTAMP created_at
    }

    approval_records {
        SERIAL id PK
        INTEGER media_asset_id FK
        VARCHAR approver_email
        VARCHAR approval_status
        TEXT comments
        TIMESTAMP approved_at
    }

    sync_status {
        SERIAL id PK
        INTEGER media_asset_id FK
        VARCHAR target_system
        VARCHAR sync_status
        TIMESTAMP last_sync_at
        TEXT error_message
    }

    media_assets ||--o{ processing_logs : "logs"
    media_assets ||--o{ approval_records : "approvals"
    media_assets ||--o{ sync_status : "sync"
                </div>
            </div>

            <h3 class="content-section__subtitle">Redis Cache Architecture</h3>
            <div class="mermaid-container">
                <div class="mermaid">
graph TB
    subgraph "Queue Keys"
        QPM["queue:media:pending<br/>üìã Pending files"]
        QPR["queue:media:processing<br/>‚öôÔ∏è Active processing"]
        QPF["queue:media:failed<br/>‚ùå Failed attempts"]
    end

    subgraph "Cache Keys"
        CF["cache:folder:ID<br/>üìÅ Folder metadata"]
        CP["cache:product:SKU<br/>üè∑Ô∏è Product info"]
        CC["cache:cloudinary:ID<br/>üåê CDN URLs"]
    end

    subgraph "Lock Keys"
        LF["lock:file:ID<br/>üîí Processing lock"]
        LW["lock:workflow:ID<br/>‚ö° Workflow lock"]
    end
                </div>
            </div>

            <h3 class="content-section__subtitle">Database Schema Implementation</h3>
            <pre class="code-block">
-- Media Assets Table
CREATE TABLE media_assets (
    id SERIAL PRIMARY KEY,
    drive_file_id VARCHAR(255) UNIQUE NOT NULL,
    weaviate_object_id UUID,
    mcp_id VARCHAR(255),
    product_name VARCHAR(255),
    sku VARCHAR(100),
    file_name VARCHAR(500),
    file_size BIGINT,
    mime_type VARCHAR(100),
    drive_folder_path TEXT,
    cloudinary_url TEXT,
    cloudinary_public_id VARCHAR(255),
    cloudinary_transformations JSONB,
    processing_status VARCHAR(50) DEFAULT 'PENDING',
    ai_description TEXT,
    ai_tags TEXT[],
    plm_stage VARCHAR(50),
    designer_id VARCHAR(100),
    revision VARCHAR(20),
    linked_bom VARCHAR(100),
    quality_score DECIMAL(3,2),
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW(),
    processed_at TIMESTAMP,
    INDEX idx_sku (sku),
    INDEX idx_status (processing_status),
    INDEX idx_mcp (mcp_id)
);

-- Processing Logs Table
CREATE TABLE processing_logs (
    id SERIAL PRIMARY KEY,
    media_asset_id INTEGER REFERENCES media_assets(id),
    workflow_id VARCHAR(100),
    step_name VARCHAR(100),
    status VARCHAR(50),
    message TEXT,
    metadata JSONB,
    created_at TIMESTAMP DEFAULT NOW()
);

-- Approval Records Table
CREATE TABLE approval_records (
    id SERIAL PRIMARY KEY,
    media_asset_id INTEGER REFERENCES media_assets(id),
    approver_email VARCHAR(255),
    approval_status VARCHAR(50),
    comments TEXT,
    approved_at TIMESTAMP,
    created_at TIMESTAMP DEFAULT NOW()
);

-- Sync Status Table
CREATE TABLE sync_status (
    id SERIAL PRIMARY KEY,
    media_asset_id INTEGER REFERENCES media_assets(id),
    target_system VARCHAR(50), -- 'ERPNEXT', 'WOOCOMMERCE', 'WEBFLOW'
    sync_status VARCHAR(50),
    last_sync_at TIMESTAMP,
    error_message TEXT,
    retry_count INTEGER DEFAULT 0
);
            </pre>

            <h3 class="content-section__subtitle">Weaviate Vector Schema</h3>
            <pre class="code-block">
{
  "class": "MediaAsset",
  "description": "DSI product media assets with AI-generated metadata",
  "vectorizer": "text2vec-openai",
  "properties": [
    {
      "name": "productName",
      "dataType": ["string"],
      "description": "Product name from folder structure"
    },
    {
      "name": "sku",
      "dataType": ["string"],
      "description": "Stock keeping unit identifier"
    },
    {
      "name": "description",
      "dataType": ["text"],
      "description": "AI-generated content description"
    },
    {
      "name": "tags",
      "dataType": ["string[]"],
      "description": "AI-generated semantic tags"
    },
    {
      "name": "colors",
      "dataType": ["string[]"],
      "description": "Detected color palette"
    },
    {
      "name": "qualityScore",
      "dataType": ["number"],
      "description": "AI-assessed quality rating (0-10)"
    },
    {
      "name": "mcpId",
      "dataType": ["string"],
      "description": "Model Context Protocol identifier"
    }
  ]
}
            </pre>
        </section>

        <section id="event-processing" class="content-section">
            <h2 class="content-section__title">Event Processing Pipeline</h2>

            <h3 class="content-section__subtitle">RabbitMQ Exchange and Queue Architecture</h3>
            <div class="mermaid-container">
                <div class="mermaid">
flowchart LR
  subgraph RabbitMQ
    E[(drive.events EXCHANGE)]
    subgraph Queues
      Qdoc[(document_ingest_queue)]
      Qimg[(image_ingest_queue)]
      Qvid[(video_ingest_queue)]
      Q3d[(3d_model_ingest_queue)]
      Qaud[(audio_ingest_queue)]
      Qapp[(approval_request_queue)]
      Qpub[(publish_market_queue)]
    end

    E -->|file.document.*| Qdoc
    E -->|file.approved.image.*| Qimg
    E -->|file.approved.video.*| Qvid
    E -->|file.approved.3d_model.*| Q3d
    E -->|file.approved.audio.*| Qaud

    E -->|file.image.created| Qapp
    E -->|file.video.created| Qapp
    E -->|file.3d_model.created| Qapp
    E -->|file.audio.created| Qapp

    E -->|file.publish.*| Qpub
  end

  subgraph n8n Workflows
    Qdoc --> Wdoc[Document Ingest]
    Qimg --> Wimg[Image Ingest]
    Qvid --> Wvid[Video Ingest]
    Q3d --> W3d[3D Model Ingest]
    Qaud --> Waud[Audio Ingest]
    Qapp --> Wapp[Approval Request]
    Qpub --> Wpub[Publish to Market]
  end
                </div>
            </div>

            <h3 class="content-section__subtitle">Event Routing Strategy</h3>
            <p>The RabbitMQ exchange system implements intelligent routing based on file types and processing status. Documents are automatically processed without approval requirements, while media files require approval before proceeding to specialized ingest workflows. This design ensures appropriate quality control while maintaining processing efficiency for different asset types.</p>

            <h3 class="content-section__subtitle">Queue Management</h3>
            <table class="data-table">
                <thead>
                    <tr>
                        <th scope="col">Queue Name</th>
                        <th scope="col">Routing Key Pattern</th>
                        <th scope="col">Processing Type</th>
                        <th scope="col">Approval Required</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td data-label="Queue Name">document_ingest_queue</td><td data-label="Routing Key Pattern">file.document.*</td><td data-label="Processing Type">Automatic OCR</td><td data-label="Approval Required">No</td></tr>
                    <tr><td data-label="Queue Name">image_ingest_queue</td><td data-label="Routing Key Pattern">file.approved.image.*</td><td data-label="Processing Type">AI Analysis + CDN</td><td data-label="Approval Required">Yes</td></tr>
                    <tr><td data-label="Queue Name">video_ingest_queue</td><td data-label="Routing Key Pattern">file.approved.video.*</td><td data-label="Processing Type">Video Processing</td><td data-label="Approval Required">Yes</td></tr>
                    <tr><td data-label="Queue Name">3d_model_ingest_queue</td><td data-label="Routing Key Pattern">file.approved.3d_model.*</td><td data-label="Processing Type">3D Asset Processing</td><td data-label="Approval Required">Yes</td></tr>
                    <tr><td data-label="Queue Name">audio_ingest_queue</td><td data-label="Routing Key Pattern">file.approved.audio.*</td><td data-label="Processing Type">Audio Processing</td><td data-label="Approval Required">Yes</td></tr>
                    <tr><td data-label="Queue Name">approval_request_queue</td><td data-label="Routing Key Pattern">file.*.created</td><td data-label="Processing Type">Approval Workflow</td><td data-label="Approval Required">N/A</td></tr>
                    <tr><td data-label="Queue Name">publish_market_queue</td><td data-label="Routing Key Pattern">file.publish.*</td><td data-label="Processing Type">Multi-platform Sync</td><td data-label="Approval Required">No</td></tr>
                </tbody>
            </table>

            <h3 class="content-section__subtitle">Message Flow Architecture</h3>
            <pre class="code-block">
1. Google Drive File Event
   ‚Üì
2. Pub/Sub Notification
   ‚Üì
3. Cloud Function Processing
   ‚Üì
4. RabbitMQ Message Publication
   ‚Üì
5. Queue Routing (based on file type)
   ‚Üì
6. n8n Workflow Trigger
   ‚Üì
7. Processing Pipeline Execution
   ‚Üì
8. Database Status Update
   ‚Üì
9. Downstream System Notification
            </pre>
        </section>

        <section id="approval-workflows" class="content-section">
            <h2 class="content-section__title">Approval Workflows</h2>

            <h3 class="content-section__subtitle">Approval Request Creation Flow</h3>
            <div class="mermaid-container1">
                <div class="mermaid">
flowchart TB
  subgraph "Create Approval Request"
    B[üê∞ RabbitMQ Trigger]
    B --> C[üõ†Ô∏è Parse Drive Event]
    C --> D[üí¨ Post Google Chat Card]
    C --> E[üìÑ Append to Google Sheet]
    
    D --> F[üåê HTTP Webhook<br/>await button click]

  end

  H[üõ†Ô∏è Parse Chat-Callback/Sheet Update]

  H --> I{‚úÖ Approved?}
  I -->|Yes| J[üì§ Publish `approved.file.media.`]
  I -->|No| K[üì§ Publish `rejected.file.media.`]

  J --> L[üöÄ Media Ingest Workflow]
  K --> M[‚ùå Rejection Handler]
                </div>
            </div>

            <h3 class="content-section__subtitle">Multi-Channel Approval System</h3>
            <p>The approval system implements a sophisticated multi-channel approach that accommodates different team preferences and workflows. Team members can approve or reject media assets through Google Chat interactive cards, Google Sheets collaborative editing, or Google Forms structured submissions. This flexibility ensures that approval workflows integrate seamlessly with existing team communication patterns.</p>

            <h3 class="content-section__subtitle">Approval Workflow Implementation</h3>
            <p>Based on the n8n workflow analysis, the Create Approval Request workflow demonstrates sophisticated integration between RabbitMQ message consumption, PostgreSQL database operations, and multi-channel notification systems. The workflow parses incoming drive events, creates comprehensive database records, and simultaneously posts interactive approval cards to Google Chat while logging requests in Google Sheets for audit trail purposes.</p>

            <h3 class="content-section__subtitle">Decision Processing Logic</h3>
            <p>The Receive Approval workflow handles decision consolidation from multiple sources with intelligent conflict resolution. When approvals are received from multiple channels, the system prioritizes the most recent decision while maintaining complete audit trails. File status updates in PostgreSQL trigger automatic Google Drive file organization, moving rejected files to designated folders and approved files to processing queues.</p>

            <h3 class="content-section__subtitle">Approval Status Matrix</h3>
            <table class="data-table">
                <thead>
                    <tr>
                        <th scope="col">Approval Channel</th>
                        <th scope="col">Response Time</th>
                        <th scope="col">Automation Level</th>
                        <th scope="col">Audit Trail</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td data-label="Approval Channel">Google Chat Cards</td><td data-label="Response Time">Real-time</td><td data-label="Automation Level">Fully Automated</td><td data-label="Audit Trail">Complete</td></tr>
                    <tr><td data-label="Approval Channel">Google Sheets</td><td data-label="Response Time">Near Real-time</td><td data-label="Automation Level">Semi-Automated</td><td data-label="Audit Trail">Complete</td></tr>
                    <tr><td data-label="Approval Channel">Google Forms</td><td data-label="Response Time">Batch Processing</td><td data-label="Automation Level">Manual Entry</td><td data-label="Audit Trail">Complete</td></tr>
                    <tr><td data-label="Approval Channel">System Auto-Approval</td><td data-label="Response Time">Immediate</td><td data-label="Automation Level">Fully Automated</td><td data-label="Audit Trail">System Generated</td></tr>
                </tbody>
            </table>
        </section>

        <section id="media-processing" class="content-section">
            <h2 class="content-section__title">Media Processing</h2>

            <h3 class="content-section__subtitle">Document Processing Pipeline</h3>
            <p>The document ingest workflow implements a sophisticated dual-engine OCR approach using both Mistral AI and AWS Textract for maximum text extraction accuracy. Documents automatically bypass the approval process and proceed directly to processing, where extracted text is indexed in both PostgreSQL for structured queries and Weaviate for semantic search capabilities.</p>

            <h3 class="content-section__subtitle">AI-Powered Media Analysis</h3>
            <p>Media assets undergo comprehensive AI analysis using OpenAI Vision API for content understanding and automatic tagging. The system generates detailed metadata including product type identification, color palette extraction, material recognition, style classification, and quality assessment scoring. This metadata is stored as vectors in Weaviate to enable sophisticated semantic search across the entire media repository.</p>

            <h3 class="content-section__subtitle">CDN Optimization Strategy</h3>
            <p>Cloudinary integration provides automatic format optimization and global distribution through intelligent CDN routing. The system generates multiple format variants including thumbnails for quick previews, web-optimized versions for online display, social media formats for marketing distribution, and print-quality versions for production materials. All transformations are performed automatically based on predefined optimization rules.</p>

            <h3 class="content-section__subtitle">Processing Status Tracking</h3>
            <table class="data-table">
                <thead>
                    <tr>
                        <th scope="col">Processing Stage</th>
                        <th scope="col">Status Code</th>
                        <th scope="col">Duration (Avg)</th>
                        <th scope="col">Success Rate</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td data-label="Processing Stage">Initial Upload</td><td data-label="Status Code">PENDING</td><td data-label="Duration (Avg)">< 1 second</td><td data-label="Success Rate">99.9%</td></tr>
                    <tr><td data-label="Processing Stage">AI Analysis</td><td data-label="Status Code">ANALYZING</td><td data-label="Duration (Avg)">15-30 seconds</td><td data-label="Success Rate">98.5%</td></tr>
                    <tr><td data-label="Processing Stage">Vector Storage</td><td data-label="Status Code">INDEXING</td><td data-label="Duration (Avg)">5-10 seconds</td><td data-label="Success Rate">99.2%</td></tr>
                    <tr><td data-label="Processing Stage">CDN Upload</td><td data-label="Status Code">OPTIMIZING</td><td data-label="Duration (Avg)">10-20 seconds</td><td data-label="Success Rate">99.7%</td></tr>
                    <tr><td data-label="Processing Stage">Format Generation</td><td data-label="Status Code">TRANSFORMING</td><td data-label="Duration (Avg)">20-45 seconds</td><td data-label="Success Rate">99.1%</td></tr>
                    <tr><td data-label="Processing Stage">Database Update</td><td data-label="Status Code">FINALIZING</td><td data-label="Duration (Avg)">2-5 seconds</td><td data-label="Success Rate">99.8%</td></tr>
                    <tr><td data-label="Processing Stage">Processing Complete</td><td data-label="Status Code">OPTIMIZED</td><td data-label="Duration (Avg)">N/A</td><td data-label="Success Rate">98.9%</td></tr>
                </tbody>
            </table>
        </section>

        <section id="external-integrations" class="content-section">
            <h2 class="content-section__title">External Integrations</h2>

            <h3 class="content-section__subtitle">ERPNext Synchronization</h3>
            <p>The ERPNext integration maintains bidirectional synchronization between the media repository and product management system. Scheduled workflows update product records with optimized media URLs, ensuring that inventory management, pricing, and bill-of-materials (BOM) tracking remain synchronized with the latest approved media assets. The integration supports both individual product updates and bulk synchronization operations.</p>

            <h3 class="content-section__subtitle">Cloudinary Configuration</h3>
            <pre class="code-block">
// DSI Upload Preset Configuration
{
  "name": "dsi-product-media",
  "unsigned": false,
  "folder": "dsi/products",
  "allowed_formats": ["jpg", "png", "webp", "mp4", "mov"],
  "transformation": [
    {
      "quality": "auto:best",
      "fetch_format": "auto"
    }
  ],
  "eager": [
    {
      "width": 150,
      "height": 150,
      "crop": "thumb",
      "gravity": "auto"
    },
    {
      "width": 800,
      "quality": "auto",
      "fetch_format": "auto"
    },
    {
      "width": 1200,
      "height": 630,
      "crop": "fill",
      "gravity": "auto"
    }
  ],
  "eager_async": true,
  "auto_tagging": 80,
  "categorization": "google_tagging",
  "detection": "adv_face"
}
            </pre>

            <h3 class="content-section__subtitle">WooCommerce & Webflow Integration</h3>
            <p>The publication workflow orchestrates final asset distribution across WooCommerce for eCommerce operations and Webflow for marketing website management. The system ensures synchronized product information and media assets across all business platforms, with automatic URL updates and format optimization for each platform's specific requirements.</p>

            <h3 class="content-section__subtitle">Integration Status Monitoring</h3>
            <table class="data-table">
                <thead>
                    <tr>
                        <th scope="col">Integration Target</th>
                        <th scope="col">Sync Frequency</th>
                        <th scope="col">Data Direction</th>
                        <th scope="col">Error Handling</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td data-label="Integration Target">ERPNext</td><td data-label="Sync Frequency">Daily (2 AM)</td><td data-label="Data Direction">Bidirectional</td><td data-label="Error Handling">Retry + Alert</td></tr>
                    <tr><td data-label="Integration Target">Cloudinary</td><td data-label="Sync Frequency">Real-time</td><td data-label="Data Direction">Upload Only</td><td data-label="Error Handling">Queue + Retry</td></tr>
                    <tr><td data-label="Integration Target">WooCommerce</td><td data-label="Sync Frequency">Hourly</td><td data-label="Data Direction">Push Only</td><td data-label="Error Handling">Batch Retry</td></tr>
                    <tr><td data-label="Integration Target">Webflow</td><td data-label="Sync Frequency">On Approval</td><td data-label="Data Direction">Push Only</td><td data-label="Error Handling">Manual Review</td></tr>
                    <tr><td data-label="Integration Target">Google Drive</td><td data-label="Sync Frequency">Real-time</td><td data-label="Data Direction">Bidirectional</td><td data-label="Error Handling">Webhook Retry</td></tr>
                </tbody>
            </table>
        </section>

        <section id="ai-intelligence" class="content-section">
            <h2 class="content-section__title">AI & Intelligence</h2>

            <h3 class="content-section__subtitle">OpenAI Vision Integration</h3>
            <pre class="code-block">
// Image Analysis Configuration
const analyzeImage = async (imageBuffer) => {
  const prompt = `
    Analyze this luxury product image and extract:
    1. Product type and category
    2. Primary colors (hex codes if possible)
    3. Materials and textures visible
    4. Style descriptors (modern, classic, etc.)
    5. Target audience demographics
    6. Suggested marketing keywords
    7. Quality assessment (1-10)
    
    Return as structured JSON.
  `;
  
  const response = await openai.chat.completions.create({
    model: "gpt-4-vision-preview",
    messages: [{
      role: "user",
      content: [
        { type: "text", text: prompt },
        { 
          type: "image_url", 
          image_url: {
            url: `data:image/jpeg;base64,${imageBuffer.toString('base64')}`
          }
        }
      ]
    }],
    max_tokens: 500
  });
  
  return JSON.parse(response.choices[0].message.content);
};
            </pre>

            <h3 class="content-section__subtitle">Weaviate Vector Storage</h3>
            <p>Weaviate serves as the semantic search engine for the entire media repository, storing AI-generated embeddings that enable sophisticated content discovery. The system automatically generates vector representations of all media assets, allowing for queries like "find all gold jewelry with modern styling" or "locate images similar to this luxury fragrance bottle design."</p>

            <h3 class="content-section__subtitle">OCR Services Architecture</h3>
            <div class="mermaid-container5">
                <div class="mermaid">
graph TB
    subgraph DI["Document Input"]
        PDF["üìÑ PDF Documents<br>Invoices, Contracts"]
        IMG["üñºÔ∏è Scanned Images<br>Photos, Scans"]
    end
    
    subgraph OES["OCR Edge Service"]
        PRE["‚öôÔ∏è Pre-processor<br>Tesseract 5.4"]
        GCV["üëÅÔ∏è Google Cloud Vision<br>Multi-language OCR"]
        TXT["üìä AWS Textract<br>Forms & Tables"]
        MRG["üîÑ Result Merger<br>Textractor"]
    end
    
    subgraph OP["Output"]
        JSON["üìã Structured JSON<br>Extracted Data"]
        TXT2["üìù Plain Text<br>Full Content"]
        META["üè∑Ô∏è Metadata<br>Key Terms"]
    end
    
    subgraph INT["Integration"]
        WV["üîç Weaviate<br>Vector Search"]
        ERP["üìä ERPNext<br>Document Index"]
        CDN["üåê Cloudinary<br>Storage"]
        CHAT["üí¨ Google Chat<br>Notifications"]
    end
    
    PDF --> PRE
    IMG --> PRE
    PRE --> GCV
    PRE --> TXT
    GCV --> MRG
    TXT --> MRG
    MRG --> JSON
    MRG --> TXT2
    MRG --> META
    JSON --> WV
    JSON --> ERP
    JSON --> CDN
    META --> CHAT
                </div>
            </div>

            <h3 class="content-section__subtitle">Model Context Protocol (MCP)</h3>
            <p>The Model Context Protocol provides standardized metadata management across all systems in the DSI ecosystem. MCP ensures consistency and enables AI agents to understand and manage content intelligently through structured context tracking and version control.</p>

            <h3 class="content-section__subtitle">AI Processing Metrics</h3>
            <table class="data-table">
                <thead>
                    <tr>
                        <th scope="col">AI Service</th>
                        <th scope="col">Processing Time</th>
                        <th scope="col">Accuracy Rate</th>
                        <th scope="col">Cost per Asset</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td data-label="AI Service">OpenAI Vision Analysis</td><td data-label="Processing Time">15-30 seconds</td><td data-label="Accuracy Rate">94.2%</td><td data-label="Cost per Asset">$0.08</td></tr>
                    <tr><td data-label="AI Service">Weaviate Vector Generation</td><td data-label="Processing Time">5-10 seconds</td><td data-label="Accuracy Rate">98.7%</td><td data-label="Cost per Asset">$0.02</td></tr>
                    <tr><td data-label="AI Service">OCR Text Extraction</td><td data-label="Processing Time">10-25 seconds</td><td data-label="Accuracy Rate">96.8%</td><td data-label="Cost per Asset">$0.05</td></tr>
                    <tr><td data-label="AI Service">Quality Assessment</td><td data-label="Processing Time">8-15 seconds</td><td data-label="Accuracy Rate">91.5%</td><td data-label="Cost per Asset">$0.03</td></tr>
                </tbody>
            </table>
        </section>

        <section id="deployment-guide" class="content-section">
            <h2 class="content-section__title">Deployment Guide</h2>

            <h3 class="content-section__subtitle">Docker Compose Configuration</h3>
            <pre class="code-block">
version: '3.8'

services:
  n8n:
    image: n8nio/n8n:latest
    restart: unless-stopped
    ports:
      - "5678:5678"
    environment:
      - N8N_BASIC_AUTH_ACTIVE=true
      - N8N_BASIC_AUTH_USER=${N8N_USER}
      - N8N_BASIC_AUTH_PASSWORD=${N8N_PASSWORD}
      - N8N_HOST=n8n.designershaik.com
      - N8N_PROTOCOL=https
      - N8N_WEBHOOK_BASE_URL=https://n8n.designershaik.com
      - DB_TYPE=postgresdb
      - DB_POSTGRESDB_HOST=postgres
      - DB_POSTGRESDB_DATABASE=n8n
      - DB_POSTGRESDB_USER=n8n_user
      - DB_POSTGRESDB_PASSWORD=${DB_PASSWORD}
    volumes:
      - n8n_data:/home/node/.n8n
    depends_on:
      - postgres
      - redis
      - rabbitmq

  postgres:
    image: postgres:15
    restart: unless-stopped
    environment:
      - POSTGRES_USER=dsi_user
      - POSTGRES_PASSWORD=${POSTGRES_PASSWORD}
      - POSTGRES_DB=dsi_media
    volumes:
      - postgres_data:/var/lib/postgresql/data
      - ./init.sql:/docker-entrypoint-initdb.d/init.sql

  weaviate:
    image: semitechnologies/weaviate:latest
    restart: unless-stopped
    ports:
      - "8080:8080"
    environment:
      - AUTHENTICATION_ANONYMOUS_ACCESS_ENABLED=false
      - AUTHENTICATION_APIKEY_ENABLED=true
      - AUTHENTICATION_APIKEY_ALLOWED_KEYS=${WEAVIATE_API_KEY}
      - PERSISTENCE_DATA_PATH=/var/lib/weaviate
      - DEFAULT_VECTORIZER_MODULE=text2vec-openai
      - ENABLE_MODULES=text2vec-openai
      - OPENAI_APIKEY=${OPENAI_API_KEY}
    volumes:
      - weaviate_data:/var/lib/weaviate

  redis:
    image: redis:7-alpine
    restart: unless-stopped
    command: redis-server --requirepass ${REDIS_PASSWORD}
    volumes:
      - redis_data:/data

  rabbitmq:
    image: rabbitmq:3-management
    restart: unless-stopped
    ports:
      - "5672:5672"
      - "15672:15672"
    environment:
      - RABBITMQ_DEFAULT_USER=${RABBITMQ_USER}
      - RABBITMQ_DEFAULT_PASS=${RABBITMQ_PASSWORD}
    volumes:
      - rabbitmq_data:/var/lib/rabbitmq

volumes:
  n8n_data:
  postgres_data:
  weaviate_data:
  redis_data:
  rabbitmq_data:
            </pre>

            <h3 class="content-section__subtitle">Environment Configuration</h3>
            <pre class="code-block">
# .env file
N8N_USER=admin
N8N_PASSWORD=secure_password_here
DB_PASSWORD=postgres_password_here
POSTGRES_PASSWORD=postgres_password_here
WEAVIATE_API_KEY=weaviate_api_key_here
OPENAI_API_KEY=sk-proj-...
REDIS_PASSWORD=redis_password_here
RABBITMQ_USER=dsi_admin
RABBITMQ_PASSWORD=rabbitmq_password_here

# Google Cloud
GCP_PROJECT_ID=n8n-drive-integration-465208
GCP_SERVICE_ACCOUNT_EMAIL=dsi-drive-watcher@n8n-drive-integration-465208.iam.gserviceaccount.com

# Cloudinary
CLOUDINARY_CLOUD_NAME=designershaik
CLOUDINARY_API_KEY=your_api_key
CLOUDINARY_API_SECRET=your_api_secret

# ERPNext
ERPNEXT_URL=https://erp.designershaik.com
ERPNEXT_API_KEY=your_api_key
ERPNEXT_API_SECRET=your_api_secret
            </pre>

            <h3 class="content-section__subtitle">Deployment Options</h3>
            <div class="cost-comparison">
                <div class="cost-card">
                    <h4 class="cost-card__title">Development Environment</h4>
                    <p class="cost-card__price">~$12/month</p>
                    <ul>
                        <li><strong>Components:</strong> All services on Docker containers, single VPS</li>
                        <li><strong>Ideal For:</strong> Development, testing, small teams</li>
                        <li><strong>Complexity:</strong> Low</li>
                    </ul>
                </div>
                <div class="cost-card">
                    <h4 class="cost-card__title">Production Environment</h4>
                    <p class="cost-card__price">~$60/month</p>
                    <ul>
                        <li><strong>Components:</strong> Kubernetes cluster, auto-scaling, load balancing</li>
                        <li><strong>Ideal For:</strong> Production scale, high availability</li>
                        <li><strong>Complexity:</strong> Medium</li>
                    </ul>
                </div>
                <div class="cost-card">
                    <h4 class="cost-card__title">Enterprise Environment</h4>
                    <p class="cost-card__price">~$200/month</p>
                    <ul>
                        <li><strong>Components:</strong> Multi-region deployment, enterprise SLA</li>
                        <li><strong>Ideal For:</strong> Enterprise requirements, compliance</li>
                        <li><strong>Complexity:</strong> High</li>
                    </ul>
                </div>
            </div>
        </section>

        <section id="monitoring-testing" class="content-section">
            <h2 class="content-section__title">Monitoring & Testing</h2>

            <h3 class="content-section__subtitle">Testing Protocol</h3>
            <div class="mermaid-container">
                <div class="mermaid">
flowchart TB
    Upload["1Ô∏è‚É£ Test Upload<br>Initiate"]
    Queue["2Ô∏è‚É£ RabbitMQ Queue<br>Processing"]
    Logs["3Ô∏è‚É£ Verify Logs<br>Execution"]
    Process["4Ô∏è‚É£ Process Validation<br>Workflow"]
    Output["5Ô∏è‚É£ Output Check<br>Results"]
    Monitor["6Ô∏è‚É£ Monitoring Validation<br>Metrics"]
    
    Upload --> Queue
    Queue --> Logs
    Logs --> Process
    Process --> Output
    Output --> Monitor
    
    Upload -.-> UploadDetail["üì§ Upload test image to<br>Product-Images folder"]
    Queue -.-> QueueDetail["üê∞ Verify RabbitMQ queue<br>receives message"]
    Logs -.-> LogDetail["üìä Check n8n execution logs<br>for trigger activation"]
    Process -.-> ProcessDetail["‚úÖ Confirm workflow<br>processes file correctly"]
    Output -.-> OutputDetail["üåê Verify Cloudinary URLs in<br>Processed-Media folder"]
    Monitor -.-> MonitorDetail["üìà Check monitoring dashboard<br>for metrics updates"]
                </div>
            </div>

            <h3 class="content-section__subtitle">Performance Monitoring</h3>
            <p>The system implements comprehensive monitoring across all components including RabbitMQ queue depths, PostgreSQL query performance, Weaviate vector search response times, and Cloudinary transformation success rates. Automated alerts notify the team of any performance degradation or system failures through Google Chat integration.</p>

            <h3 class="content-section__subtitle">Key Performance Indicators</h3>
            <table class="data-table">
                <thead>
                    <tr>
                        <th scope="col">Metric Category</th>
                        <th scope="col">Key Indicator</th>
                        <th scope="col">Target Value</th>
                        <th scope="col">Alert Threshold</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td data-label="Metric Category">Queue Performance</td><td data-label="Key Indicator">Average Processing Time</td><td data-label="Target Value">< 2 minutes</td><td data-label="Alert Threshold">> 5 minutes</td></tr>
                    <tr><td data-label="Metric Category">Database Performance</td><td data-label="Key Indicator">Query Response Time</td><td data-label="Target Value">< 100ms</td><td data-label="Alert Threshold">> 500ms</td></tr>
                    <tr><td data-label="Metric Category">AI Processing</td><td data-label="Key Indicator">Success Rate</td><td data-label="Target Value">> 95%</td><td data-label="Alert Threshold">< 90%</td></tr>
                    <tr><td data-label="Metric Category">CDN Performance</td><td data-label="Key Indicator">Upload Success Rate</td><td data-label="Target Value">> 99%</td><td data-label="Alert Threshold">< 95%</td></tr>
                    <tr><td data-label="Metric Category">System Availability</td><td data-label="Key Indicator">Uptime Percentage</td><td data-label="Target Value">> 99.5%</td><td data-label="Alert Threshold">< 99%</td></tr>
                </tbody>
            </table>

            <h3 class="content-section__subtitle">Testing Procedures</h3>
            <pre class="code-block">
# End-to-End Testing Script
1. Upload test image to: DSI-Product-Repository/Palace-of-Fragrances/Classic-Range/Opulent-Shaik-Amethyst/Media/Images/

2. Monitor RabbitMQ queue:
   docker exec rabbitmq rabbitmqctl list_queues

3. Check n8n execution logs:
   docker logs dsi_n8n_1 --tail 100 -f

4. Verify PostgreSQL record:
   SELECT * FROM media_assets 
   WHERE drive_file_id = 'YOUR_FILE_ID';

5. Check Weaviate storage:
   curl http://localhost:8080/v1/objects?class=MediaAsset

6. Verify Cloudinary upload:
   https://res.cloudinary.com/designershaik/image/upload/dsi/...

7. Confirm ERP synchronization:
   Check ERPNext product record for updated media URLs

8. Validate monitoring metrics:
   Review dashboard for processing completion
            </pre>
        </section>

    </main>

    <footer class="footer">
        <p>¬© 2025 DSI Media Repository Architecture Guide</p>
        <p>This documentation provides complete technical specifications for deploying the DSI Media Repository Integration Architecture with automated workflows, intelligent approval systems, and comprehensive monitoring.</p>
        <p>Architecture: Event-driven RabbitMQ processing with multi-channel approval workflows, AI-powered content analysis, and automated cross-platform synchronization</p>
        <p>Maintained by: DSI Technical Team</p>
    </footer>

    <button class="back-to-top" id="backToTop" aria-label="Back to top">‚Üë</button>

<script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.6.1/mermaid.min.js"></script>
<script src="script.js"></script>
</body>
</html>
