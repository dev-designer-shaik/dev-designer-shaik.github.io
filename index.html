<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>DesignerShaik Documentation ‚Äì Unified Digital Ecosystem Guide</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header class="header">
        <div class="header__content">
            <div class="header__logo-container">
                <img src="logo.webp" alt="DesignerShaik Logo" class="header__logo" >
                <button class="header__sidebar-toggle" id="sidebarToggle" aria-label="Toggle menu">Menu</button>
            </div>
            <div class="header__text">
                <h1 class="header__title">DesignerShaik Development Documentation</h1>
                <p class="header__subtitle">Automation and AI Agent ‚Äì Unified Digital Ecosystem Guide</p>
            </div>
            <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">üåô</button>
        </div>
    </header>
    <nav class="sidebar-nav" id="sidebarNav">
        <div class="nav-header">
            <button class="nav-collapse-btn" id="navCollapseBtn" aria-label="Collapse navigation">
                <span class="nav-collapse-icon">‚óÄ</span>
            </button>
        </div>
        <ul class="nav-links">
            <li><a href="#purpose" data-section="purpose">Purpose & Scope</a></li>
            <li><a href="#governance" data-section="governance">Governance</a></li>
            <li><a href="#workspace" data-section="workspace">Workspace</a></li>
            <li><a href="#repository" data-section="repository">Repository</a></li>
            <li><a href="#database" data-section="database">Database</a></li>
            <li><a href="#automation" data-section="automation">Automation</a></li>
            <li><a href="#ai-agents" data-section="ai-agents">AI Agents</a></li>
            <li><a href="#mcp-integration" data-section="mcp-integration">MCP Integration</a></li>
            <li><a href="#enhanced-workflows" data-section="enhanced-workflows">Enhanced Workflows</a></li>
            <li><a href="#ocr-services" data-section="ocr-services">OCR Services</a></li>
            <li><a href="#plm-enhancement" data-section="plm-enhancement">PLM Enhancement</a></li>
            <li><a href="#implementation" data-section="implementation">Implementation</a></li>
            <li><a href="#deployment" data-section="deployment">Deployment</a></li>
            <li><a href="#testing" data-section="testing">Testing</a></li>
        </ul>
    </nav>

    <main class="main-content" id="main-content">

        <section id="purpose" class="content-section">
            <h2 class="content-section__title">Purpose & Scope</h2>
            <p>The DSI Media Repository Integration Architecture is a comprehensive, AI-powered digital asset management ecosystem that automates the complete lifecycle of luxury product media from initial design concepts through production-ready marketing assets. This unified guide consolidates the DSI Media Repository Integration Architecture into a single, comprehensive digital stack that replaces piecemeal PDFs and chat notes with a single, searchable HTML reference. Content is sourced from the technical specifications and implementation guidelines.</p>

            <h3 class="content-section__subtitle">Core Architecture Overview</h3>
            <ul>
                <li><strong>Source:</strong> Google Drive hierarchical repository structure</li>
                <li><strong>Processing:</strong> n8n workflow automation with AI-powered analysis</li>
                <li><strong>Storage:</strong> Multi-tier approach with Weaviate vector database and PostgreSQL</li>
                <li><strong>Distribution:</strong> Cloudinary CDN optimization and multi-platform sync</li>
                <li><strong>Intelligence:</strong> OpenAI-powered metadata extraction and MCP compliance</li>
            </ul>

            <h3 class="content-section__subtitle">Core Technologies Used</h3>
            <div class="diagram-split">
                <div class="diagram-part">
                    <h4>Data Sources & Processing</h4>
                    <div class="mermaid-container">
                        <div class="mermaid">
graph TB
    subgraph DS["Data Sources"]
        GD["üóÇÔ∏è Google Drive<br>Primary Source"]
        QNAP["üíæ QNAP NAS<br>Local Backup"]
        S3["‚òÅÔ∏è AWS S3/GCS<br>Cold Storage"]
    end

    subgraph PL["Processing Layer"]
        N8N["‚öôÔ∏è n8n<br>Workflow Engine"]
        OAI["ü§ñ OpenAI<br>AI Analysis"]
        PS["üì° Google Pub/Sub<br>Event Transport"]
        MA["üéØ Manus/Abacus<br>AI Agents"]
    end

    GD --> PS
    PS --> N8N
    N8N --> MA
    N8N --> OAI
                        </div>
                    </div>
                </div>
                
                <div class="diagram-part">
                    <h4>Storage & Distribution</h4>
                    <div class="mermaid-container">
                        <div class="mermaid">
graph TB
    subgraph ST["Storage"]
        WV["üîç Weaviate<br>Vector Search"]
        PG["üóÑÔ∏è PostgreSQL<br>Metadata & Logs"]
    end
    
    subgraph DT["Distribution"]
        CDN["üåê Cloudinary<br>Media Optimization"]
        VJ["üìπ Vidjet<br>Video Hosting"]
        GC["üí¨ Google Chat<br>Notifications"]
    end
    
    subgraph BS["Business Systems"]
        ERP["üìä ERPNext<br>Product Management"]
        WC["üõí WooCommerce<br>eCommerce"]
        WF["üé® Webflow<br>Marketing"]
    end
    
    WV --> ERP
    CDN --> WC
    CDN --> WF
                        </div>
                    </div>
                </div>
            </div>

            <table class="data-table">
                <thead>
                    <tr>
                        <th scope="col">Category</th>
                        <th scope="col">Technology</th>
                        <th scope="col">Primary Function</th>
                        <th scope="col">Integration Points</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td data-label="Category">Source Control</td><td data-label="Technology">Google Drive</td><td data-label="Primary Function">Primary media repository</td><td data-label="Integration Points">n8n triggers, AI processing</td></tr>
                    <tr><td data-label="Category">Orchestration</td><td data-label="Technology">n8n</td><td data-label="Primary Function">Workflow automation engine</td><td data-label="Integration Points">All systems integration hub</td></tr>
                    <tr><td data-label="Category">Vector Database</td><td data-label="Technology">Weaviate</td><td data-label="Primary Function">AI-powered semantic search</td><td data-label="Integration Points">OpenAI embeddings, metadata</td></tr>
                    <tr><td data-label="Category">Relational DB</td><td data-label="Technology">PostgreSQL</td><td data-label="Primary Function">Structured metadata storage</td><td data-label="Integration Points">Audit logs, processing status</td></tr>
                    <tr><td data-label="Category">AI Processing</td><td data-label="Technology">OpenAI</td><td data-label="Primary Function">Content analysis & tagging</td><td data-label="Integration Points">Weaviate vectors, metadata</td></tr>
                    <tr><td data-label="Category">AI Agents</td><td data-label="Technology">Manus/Abacus</td><td data-label="Primary Function">Automated system configuration</td><td data-label="Integration Points">All systems orchestration</td></tr>
                    <tr><td data-label="Category">CDN & Optimization</td><td data-label="Technology">Cloudinary</td><td data-label="Primary Function">Media transformation & delivery</td><td data-label="Integration Points">URL generation, format optimization</td></tr>
                    <tr><td data-label="Category">Video Platform</td><td data-label="Technology">Vidjet</td><td data-label="Primary Function">Product video hosting</td><td data-label="Integration Points">Short-form videos, demos</td></tr>
                    <tr><td data-label="Category">Local Backup</td><td data-label="Technology">QNAP NAS</td><td data-label="Primary Function">On-premise redundancy</td><td data-label="Integration Points">Real-time Drive sync</td></tr>
                    <tr><td data-label="Category">Event Messaging</td><td data-label="Technology">Google Pub/Sub</td><td data-label="Primary Function">Real-time event processing</td><td data-label="Integration Points">File upload triggers</td></tr>
                    <tr><td data-label="Category">Communications</td><td data-label="Technology">Google Chat + Gemini AI</td><td data-label="Primary Function">Team collaboration & AI assistance</td><td data-label="Integration Points">Workflow status, AI Q&A</td></tr>
                    <tr><td data-label="Category">Task Management</td><td data-label="Technology">Gameplan</td><td data-label="Primary Function">Visual workflow tracking</td><td data-label="Integration Points">Task execution, Kanban boards</td></tr>
                    <tr><td data-label="Category">Documentation</td><td data-label="Technology">Raven AI</td><td data-label="Primary Function">Decision logging & tracking</td><td data-label="Integration Points">AI-powered documentation</td></tr>
                    <tr><td data-label="Category">Cold Storage</td><td data-label="Technology">AWS S3/Google Cloud Storage</td><td data-label="Primary Function">Long-term archival</td><td data-label="Integration Points">Data lake, compliance</td></tr>
                    <tr><td data-label="Category">ERP</td><td data-label="Technology">ERPNext</td><td data-label="Primary Function">Product & inventory management</td><td data-label="Integration Points">SKU, pricing, BOM tracking</td></tr>
                    <tr><td data-label="Category">eCommerce</td><td data-label="Technology">WooCommerce</td><td data-label="Primary Function">Online product sales</td><td data-label="Integration Points">Product listings, media sync</td></tr>
                    <tr><td data-label="Category">Marketing</td><td data-label="Technology">Webflow</td><td data-label="Primary Function">Marketing websites</td><td data-label="Integration Points">Content management, CDN</td></tr>
                </tbody>
            </table>
        </section>

        <section id="governance" class="content-section">
            <h2 class="content-section__title">Governance & IP Ownership</h2>
            <h3 class="content-section__subtitle">IP Hierarchy</h3>
            <div class="mermaid-container">
                <div class="mermaid">
graph TB
    MH["üè¢ Marayai Holdings<br>Parent Company"]
    SF["üåü Shaikdom Foundation<br>Non-Profit Arm"]
    DSS["üé® Designer Shaik Studio<br>Creative Unit"]
    DSI["üìÅ DSI Product Repository<br>Content Hub"]
    
    MH --> SF
    MH --> DSS
    DSS --> DSI
    SF --> DSI
    
    style MH fill:#2563eb,stroke:#1d4ed8,stroke-width:2px,color:#fff
    style SF fill:#16a34a,stroke:#15803d,stroke-width:2px,color:#fff
    style DSS fill:#dc2626,stroke:#b91c1c,stroke-width:2px,color:#fff
    style DSI fill:#f59e0b,stroke:#d97706,stroke-width:2px,color:#fff
                </div>
            </div>
            <h3 class="content-section__subtitle">Digital Asset Ownership</h3>
            <p>All digital assets created or acquired by any entity within the Marayai ecosystem are ultimately owned by Marayai Holdings. Usage rights, licensing, and distribution are governed by specific protocols outlined in this guide.</p>
            <h3 class="content-section__subtitle">Compliance & Legal</h3>
            <p>Adherence to regional data privacy laws (e.g., GDPR, ADGM) and international intellectual property regulations is mandatory. Regular audits are conducted to ensure compliance.</p>
        </section>

        <section id="workspace" class="content-section">
            <h2 class="content-section__title">Google Workspace OU / Shared-Drive Architecture</h2>
            <p>The Google Workspace environment is structured to reflect the organizational hierarchy and facilitate efficient collaboration and data management. Shared drives are used for centralized access and governance of key digital assets. Google Drive serves as the primary media repository with structured organizational units (OUs) that mirror the corporate structure, allowing for granular policy application and user management.</p>

            <h3 class="content-section__subtitle">Current Workspace Shared Drives Directory</h3>
            <pre class="code-block">
[SANDBOX] DSI 06 - Media Repository
‚îú‚îÄ‚îÄ DSI-Product-Repository/
‚îÇ   ‚îú‚îÄ‚îÄ Palace-of-Fragrances/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Classic-Range/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Opulent-Shaik-Amethyst/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Chic-Shaik-Emerald/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Amber-Kroud/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Opulent-Shaik-Sapphire/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Sochi-Onyx/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Precious-Range/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ Objet-d-Art-Luxury-Sterling-Silver/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ Objet-d-Art-Optimum-Precious-Gold/
‚îÇ   ‚îú‚îÄ‚îÄ Palace-of-Precision/
‚îÇ   ‚îî‚îÄ‚îÄ Palace-of-Style/
‚îî‚îÄ‚îÄ Processed-Media/
    ‚îú‚îÄ‚îÄ ERP-Integrated/
    ‚îú‚îÄ‚îÄ Social-Media-Posts/
    ‚îî‚îÄ‚îÄ Web-Optimized/
            </pre>
        </section>

        <section id="repository" class="content-section">
            <h2 class="content-section__title">DSI Repository Structure</h2>
            <p>The DSI Media Repository Integration Architecture is an end-to-end automated media processing pipeline that streamlines the management of digital assets for DSI's luxury product lines. The system automatically ingests media files from Google Drive, processes them through AI services, stores semantic vectors in Weaviate, logs metadata in PostgreSQL, and optimizes media for CDN distribution.</p>

            <h3 class="content-section__subtitle">Repository Folder Structure</h3>
            <div class="diagram-split">
                <div class="diagram-part">
                    <h4>System Structure</h4>
                    <div class="mermaid-container">
                        <div class="mermaid">
graph TB
    Root["üìÅ DSI-Product-Repository"]
    
    subgraph SF["System Folders"]
        Meta["üìã Metadata"]
        Proc["‚ö° Processed-Media"]
    end
    
    subgraph MS["Metadata Structure"]
        Tag["üè∑Ô∏è Tagging-Data"]
        AI["ü§ñ AI-Generated-Tags"]
        Multi["üåê Multilingual-Descriptions"]
        Ver["üìù Version-Control"]
        Change["üìä Media-Change-History"]
        Approval["‚úÖ Approval-Stages"]
        MCP["üîó MCP-Context"]
    end
    
    Root --> SF
    Meta --> MS
    
    style Root fill:#2563eb,stroke:#1d4ed8,stroke-width:2px,color:#fff
    style Meta fill:#16a34a,stroke:#15803d,stroke-width:2px,color:#fff
    style Proc fill:#dc2626,stroke:#b91c1c,stroke-width:2px,color:#fff
                        </div>
                    </div>
                </div>
                
                <div class="diagram-part">
                    <h4>Product Structure</h4>
                    <div class="mermaid-container">
                        <div class="mermaid">
graph TB
    subgraph PP["Product Palaces"]
        PF["üå∏ Palace-of-Fragrances"]
        PPR["‚öôÔ∏è Palace-of-Precision"]
        PS["üëî Palace-of-Style"]
    end
    
    subgraph POF["Palace of Fragrances"]
        Precious["üíé Precious-Range"]
        Classic["üèõÔ∏è Classic-Range"]
    end
    
    subgraph PR["Precious Range"]
        OptimumGold["ü•á Objet-d-Art-Optimum<br>Precious-Gold"]
        SterlinSilver["ü•à Objet-d-Art-Luxury<br>Sterling-Silver"]
    end
    
    subgraph CR["Classic Range"]
        Amethyst["üíú Opulent-Shaik<br>Amethyst"]
        Sapphire["üíô Opulent-Shaik<br>Sapphire"]
        Emerald["üíö Chic-Shaik<br>Emerald"]
        Onyx["üñ§ Sochi-Onyx"]
        Amber["üß° Amber-Kroud"]
    end
    
    PF --> POF
    Precious --> PR
    Classic --> CR
    
    style PF fill:#2563eb,stroke:#1d4ed8,stroke-width:2px,color:#fff
    style Precious fill:#16a34a,stroke:#15803d,stroke-width:2px,color:#fff
    style Classic fill:#dc2626,stroke:#b91c1c,stroke-width:2px,color:#fff
                        </div>
                    </div>
                </div>
            </div>

            <h3 class="content-section__subtitle">File Naming Convention</h3>
            <div class="highlight-box">
                <strong>Pattern:</strong> <code>{ProductName}_{SKU}_{descriptor}_{timestamp}.{extension}</code> <br><br>
                <strong>Examples:</strong>
                <ul>
                    <li><code>Opulent-Shaik-Amethyst_OSA-GE-100_original_20250703.jpg</code></li>
                    <li><code>Objet-d-Art-Optimum_OAO-FL-50_web_optimized.webp</code></li>
                    <li><code>AstroTime-MK1_ATM-IG-001_ai_metadata.json</code></li>
                </ul>
            </div>
        </section>

        <section id="database" class="content-section">
            <h2 class="content-section__title">Database & Data-Lake Blueprint</h2>
            <h3 class="content-section__subtitle">Advanced Indexing & Search Architecture</h3>
            <p>The DSI ecosystem leverages advanced indexing and search architectures to ensure rapid and accurate retrieval of media assets and documents, powered by vector databases and dual-engine OCR.</p>

            <h3 class="content-section__subtitle">PostgreSQL (Metadata & Logs)</h3>
            <p>Primary database for structured metadata, audit trails, and workflow logs.</p>
            <pre class="code-block">
-- Media Assets Table with MCP Support
CREATE TABLE media_assets (
    id SERIAL PRIMARY KEY,
    drive_file_id VARCHAR(255) UNIQUE,
    weaviate_object_id UUID,
    mcp_id VARCHAR(255),  -- Model Context Protocol ID
    product_name VARCHAR(255),
    sku VARCHAR(100),
    file_url TEXT,
    processing_status VARCHAR(50),
    ai_description TEXT,
    ai_tags TEXT[],
    plm_stage VARCHAR(50), -- Concept, Gate-A, Prototype, PPAP, Production
    designer_id VARCHAR(100),
    revision VARCHAR(20),
    linked_bom VARCHAR(100),
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);
            </pre>
        </section>

        <section id="automation" class="content-section">
            <h2 class="content-section__title">Automation & AI-Agent Matrix</h2>
            <table class="data-table">
                <thead>
                    <tr>
                        <th scope="col">Function Area</th>
                        <th scope="col">Tool / Agent</th>
                        <th scope="col">Relevant Sections</th>
                        <th scope="col">Key Use Case</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td data-label="Category">Media Ingestion</td><td data-label="Tool / Agent">n8n</td><td data-label="Relevant Sections">4.1</td><td data-label="Key Use Case">Google Drive ‚Üî Cloudinary sync</td></tr>
                    <tr><td data-label="Category">AI Tagging</td><td data-label="Tool / Agent">OpenAI + Weaviate</td><td data-label="Relevant Sections">4.2</td><td data-label="Key Use Case">Automatic metadata generation</td></tr>
                    <tr><td data-label="Category">CDN Optimisation</td><td data-label="Tool / Agent">Cloudinary</td><td data-label="Relevant Sections">4.3</td><td data-label="Key Use Case">Image / video format conversion</td></tr>
                    <tr><td data-label="Category">ERP Integration</td><td data-label="Tool / Agent">n8n</td><td data-label="Relevant Sections">6.2, 6.3</td><td data-label="Key Use Case">Product data sync</td></tr>
                    <tr><td data-label="Category">AI Orchestration</td><td data-label="Tool / Agent">Manus/Abacus</td><td data-label="Relevant Sections">7.1, 7.2</td><td data-label="Key Use Case">Automated system configuration</td></tr>
                    <tr><td data-label="Category">Document Processing</td><td data-label="Tool / Agent">AWS Textract + Google Vision</td><td data-label="Relevant Sections">8.1</td><td data-label="Key Use Case">OCR for invoices, contracts</td></tr>
                    <tr><td data-label="Category">Communication</td><td data-label="Tool / Agent">Google Chat + Gemini AI</td><td data-label="Relevant Sections">7.3</td><td data-label="Key Use Case">AI-powered team assistance</td></tr>
                    <tr><td data-label="Category">Task Management</td><td data-label="Tool / Agent">Gameplan + Raven</td><td data-label="Relevant Sections">7.4</td><td data-label="Key Use Case">Visual workflow tracking</td></tr>
                    <tr><td data-label="Category">Legal & Compliance</td><td data-label="Tool / Agent">Raven AI</td><td data-label="Relevant Sections">5.1</td><td data-label="Key Use Case">Compliance tracking & decisions</td></tr>
                    <tr><td data-label="Category">Investor Relations</td><td data-label="Tool / Agent">20_Marketing</td><td data-label="Relevant Sections">3.3, 3.4</td><td data-label="Key Use Case">Data-room generation</td></tr>
                    <tr><td data-label="Category">Operational Efficiency</td><td data-label="Tool / Agent">40_Technical & APIs</td><td data-label="Relevant Sections">6.2, 6.3, 6.4</td><td data-label="Key Use Case">ERP ‚Üî Weaviate sync; n8n orchestrator</td></tr>
                </tbody>
            </table>
        </section>

        <section id="ai-agents" class="content-section">
            <h2 class="content-section__title">AI Agents (Manus/Abacus) Implementation</h2>

            <h3 class="content-section__subtitle">Why Use AI Agents?</h3>
            <div class="ai-agent-section">
                <h4 class="ai-agent-section__title">Benefits of AI Agent Implementation</h4>
                <ul>
                    <li><strong>Automated Multi-System Setup:</strong> AI handles setup of complex integrations (Google Workspace, ERPNext, Weaviate, Cloudinary, WooCommerce, n8n)</li>
                    <li><strong>Configuration & Optimization:</strong> Automatically configures optimal settings based on best practices</li>
                    <li><strong>Continuous Maintenance & Scaling:</strong> AI continually adapts your workflows and updates configurations dynamically</li>
                    <li><strong>Reduced Human Error:</strong> Ensures consistent implementation across all systems</li>
                </ul>
            </div>

            <h3 class="content-section__subtitle">AI Agent Selection</h3>
            <div class="workflow-cards">
                <div class="workflow-card">
                    <h4 class="workflow-card__title">Manus AI</h4>
                    <ul>
                        <li>Specialized in automating repetitive system setups</li>
                        <li>Easy integration with APIs (ERPNext, Google, Cloudinary)</li>
                        <li>Ideal for quick configuration automation</li>
                        <li><strong>Best For:</strong> Rapid, repeatable system configurations</li>
                    </ul>
                </div>
                <div class="workflow-card">
                    <h4 class="workflow-card__title">Abacus AI</h4>
                    <ul>
                        <li>Powerful data-driven decision-making</li>
                        <li>Advanced predictive & machine-learning capabilities</li>
                        <li>Automated recommendations for continuous optimization</li>
                        <li><strong>Best For:</strong> Advanced predictive analytics and intelligent system optimization</li>
                    </ul>
                </div>
            </div>
        </section>

        <section id="mcp-integration" class="content-section">
            <h2 class="content-section__title">Model Context Protocol (MCP) Integration</h2>

            <h3 class="content-section__subtitle">What is MCP?</h3>
            <p>Model Context Protocol (MCP) provides a standardized framework for managing metadata, versioning, and context tracking across all systems in the DSI ecosystem. It ensures consistency and enables AI agents to understand and manage content intelligently.</p>

            <h3 class="content-section__subtitle">MCP Tag Structure</h3>
            <div class="highlight-box">
                <strong>Standard MCP Tag Format:</strong>
                <pre class="code-block">
MCP-ID: [ProductName]_[Version]_[Status]
Example: Opulent-Shaik-Amethyst_V1.3.3_FINAL

Fields:
- Product Name: Unique identifier for the product
- Version: Semantic versioning (Major.Minor.Patch)
- Status: DRAFT | REVIEW | FINAL | ARCHIVED
- PLM Stage: Concept | Gate-A | Prototype | PPAP | Production
- Designer ID: Staff code for IP tracking
- Revision: A00, B02, etc.
- Linked BOM: ERPNext BOM reference
                </pre>
            </div>
        </section>

        <section id="enhanced-workflows" class="content-section">
            <h2 class="content-section__title">Enhanced MCP Workflow Architecture</h2>

            <div class="diagram-container">
                <h2 class="diagram-container__title">E2E n8n-Native & Redis-Queued Architecture</h2>
                <div class="workflow-diagram-split">
                    <div class="workflow-part">
                        <h4>Event Processing Pipeline</h4>
                        <div class="mermaid-container">
                            <div class="mermaid">
flowchart TB
    subgraph EI["EVENT INGESTION"]
        A["üóÇÔ∏è Google Drive Trigger<br>File Upload"]
        B["üîÑ Switch: Filter & Dedup<br>Validate File"]
        C["‚öôÔ∏è Function: Enrich Metadata<br>Extract Properties"]
        Q["üî¥ Redis Queue<br>Priority Processing"]
    end
    
    subgraph DR["DB ROUTING"]
        D["üóÑÔ∏è PostgreSQL Lookup<br>& Row Lock"]
        E{"‚ùì File Status<br>New/Revision/Rejected"}
    end
    
    A --> B
    B --> C
    C --> Q
    Q --> D
    D --> E
    
    style A fill:#2563eb,stroke:#1d4ed8,stroke-width:2px,color:#fff
    style Q fill:#dc2626,stroke:#b91c1c,stroke-width:2px,color:#fff
    style D fill:#16a34a,stroke:#15803d,stroke-width:2px,color:#fff
                            </div>
                        </div>
                    </div>
                    
                    <div class="workflow-part">
                        <h4>Processing & Approval</h4>
                        <div class="mermaid-container">
                            <div class="mermaid">
flowchart TB
    subgraph DP["DRAFT PIPELINE"]
        F["üìä Path Analysis<br>& Classification"]
        G["üè∑Ô∏è MCP-ID Generation<br>Versioning"]
        H["üìù PostgreSQL: status=DRAFT"]
    end
    
    subgraph AS["APPROVAL SYSTEM"]
        I["üìã Create approval_record<br>PostgreSQL"]
        J{"üîÄ Approval Method<br>Forms/Sheets/Chat"}
        K["üìù Google Forms<br>Approval"]
        L["üìä Google Sheets<br>Approval"]
        M["üí¨ Google Chat<br>Approval"]
        N{"‚úÖ Decision Validation<br>Consensus Check"}
        O["‚úÖ PostgreSQL: status=APPROVED"]
    end
    
    F --> G
    G --> H
    H --> I
    I --> J
    J --> K
    J --> L
    J --> M
    K --> N
    L --> N
    M --> N
    N --> O
    
    style F fill:#2563eb,stroke:#1d4ed8,stroke-width:2px,color:#fff
    style J fill:#f59e0b,stroke:#d97706,stroke-width:2px,color:#fff
    style O fill:#16a34a,stroke:#15803d,stroke-width:2px,color:#fff
                            </div>
                        </div>
                    </div>
                    
                    <div class="workflow-part">
                        <h4>Production & Distribution</h4>
                        <div class="mermaid-container">
                            <div class="mermaid">
flowchart TB
    subgraph PP["PRODUCTION PIPELINE"]
        P["üöÄ Init Production<br>n8n Workflow"]
        R["ü§ñ OpenAI Analysis<br>Tag Generation"]
        S["üîç Weaviate Embeddings<br>Semantic Indexing"]
        T["üåê Cloudinary Optimization<br>Format Conversion"]
        U["üîó Generate Formats & URLs<br>Multi-Platform"]
        V["üìÅ Google Drive<br>Processed Folder"]
        W["‚úÖ PostgreSQL: status=OPTIMIZED"]
    end
    
    subgraph SS["SCHEDULED SYNC"]
        Z["‚è∞ Cron Trigger<br>Scheduled Sync"]
        AA["üìä Fetch OPTIMIZED<br>PostgreSQL Query"]
        BB["üìä ERPNext Sync<br>Product Data"]
        CC["üõí WooCommerce Sync<br>eCommerce Listings"]
        DD["üé® Webflow Publish<br>Marketing Content"]
        EE["üìà Status Update<br>Processing Complete"]
        FF["üéØ PostgreSQL: status=PUBLISHED"]
    end
    
    P --> R
    R --> S
    S --> T
    T --> U
    U --> V
    V --> W
    Z --> AA
    AA --> BB
    BB --> CC
    CC --> DD
    DD --> EE
    EE --> FF
    
    style P fill:#2563eb,stroke:#1d4ed8,stroke-width:2px,color:#fff
    style T fill:#16a34a,stroke:#15803d,stroke-width:2px,color:#fff
    style FF fill:#dc2626,stroke:#b91c1c,stroke-width:2px,color:#fff
                            </div>
                        </div>
                    </div>
                </div>
                <div class="diagram-container__description">
                    <p>This enhanced version uses n8n's native Google Drive Trigger and Switch/Function nodes for routing, Redis for prioritized queuing, PostgreSQL for transactional state & locking, and BigQuery/Grafana for analytics and alerts. Secrets live in n8n's credential store, and retry/DLQ logic is built-in.</p>
                </div>
            </div>

            <h3 class="content-section__subtitle">Key Workflow Improvements</h3>
            <div class="workflow-cards">
                <div class="workflow-card">
                    <h4 class="workflow-card__title">Enhanced Processing Pipeline</h4>
                    <ul>
                        <li><strong>Redis Queue Management:</strong> Priority-based processing with better load distribution</li>
                        <li><strong>PostgreSQL Row Locking:</strong> Prevents duplicate processing and ensures data consistency</li>
                        <li><strong>Consolidated Approval System:</strong> Multiple approval methods (Forms, Sheets, Chat) with unified validation</li>
                        <li><strong>Automated Revision Handling:</strong> Smart routing for rejected/revision items back to appropriate workflows</li>
                    </ul>
                </div>
                
                <div class="workflow-card">
                    <h4 class="workflow-card__title">Advanced Observability</h4>
                    <ul>
                        <li><strong>BigQuery Integration:</strong> Data lake for comprehensive analytics and reporting</li>
                        <li><strong>Grafana Dashboards:</strong> Real-time monitoring of all workflow stages</li>
                        <li><strong>Multi-Channel Alerts:</strong> Proactive notifications via Chat and Gmail</li>
                        <li><strong>Performance Metrics:</strong> Comprehensive tracking of processing times and success rates</li>
                    </ul>
                </div>
                
                <div class="workflow-card">
                    <h4 class="workflow-card__title">Intelligent Routing</h4>
                    <ul>
                        <li><strong>Path Analysis:</strong> Smart classification based on file location and metadata</li>
                        <li><strong>MCP-ID Generation:</strong> Automatic versioning and context protocol assignment</li>
                        <li><strong>Decision Validation:</strong> Multi-step approval process with fallback mechanisms</li>
                        <li><strong>Status Tracking:</strong> Complete lifecycle management from DRAFT to PUBLISHED</li>
                    </ul>
                </div>
                
                <div class="workflow-card">
                    <h4 class="workflow-card__title">Optimized Performance</h4>
                    <ul>
                        <li><strong>Scheduled Integration:</strong> Deferred heavy operations to optimize real-time performance</li>
                        <li><strong>Cron-based Sync:</strong> Efficient batch processing for ERP and eCommerce updates</li>
                        <li><strong>Multi-platform Publishing:</strong> Automated distribution to all connected systems</li>
                        <li><strong>Error Recovery:</strong> Built-in retry logic and dead letter queue handling</li>
                    </ul>
                </div>
            </div>
        </section>

        <section id="ocr-services" class="content-section">
            <h2 class="content-section__title">OCR Services & Document Intelligence</h2>

            <h3 class="content-section__subtitle">Dual-Engine OCR Architecture</h3>
            <p>Adding a dual-engine OCR service (AWS Textract + Google Cloud Vision) at the ingestion edge dramatically improves document search recall and precision across the DSI ecosystem, while feeding cleaner, structured data into ERPNext, Weaviate, Cloudinary, and legal/procurement workflows.</p>

            <h3 class="content-section__subtitle">OCR Service Architecture</h3>
            <div class="mermaid-container">
                <div class="mermaid">
graph TB
    subgraph DI["Document Input"]
        PDF["üìÑ PDF Documents<br>Invoices, Contracts"]
        IMG["üñºÔ∏è Scanned Images<br>Photos, Scans"]
    end
    
    subgraph OES["OCR Edge Service"]
        PRE["‚öôÔ∏è Pre-processor<br>Tesseract 5.4"]
        GCV["üëÅÔ∏è Google Cloud Vision<br>Multi-language OCR"]
        TXT["üìä AWS Textract<br>Forms & Tables"]
        MRG["üîÑ Result Merger<br>Textractor"]
    end
    
    subgraph OP["Output"]
        JSON["üìã Structured JSON<br>Extracted Data"]
        TXT2["üìù Plain Text<br>Full Content"]
        META["üè∑Ô∏è Metadata<br>Key Terms"]
    end
    
    subgraph INT["Integration"]
        WV["üîç Weaviate<br>Vector Search"]
        ERP["üìä ERPNext<br>Document Index"]
        CDN["üåê Cloudinary<br>Storage"]
        CHAT["üí¨ Google Chat<br>Notifications"]
    end
    
    PDF --> PRE
    IMG --> PRE
    PRE --> GCV
    PRE --> TXT
    GCV --> MRG
    TXT --> MRG
    MRG --> JSON
    MRG --> TXT2
    MRG --> META
    JSON --> WV
    JSON --> ERP
    JSON --> CDN
    META --> CHAT
    
    style PRE fill:#2563eb,stroke:#1d4ed8,stroke-width:2px,color:#fff
    style MRG fill:#16a34a,stroke:#15803d,stroke-width:2px,color:#fff
    style JSON fill:#dc2626,stroke:#b91c1c,stroke-width:2px,color:#fff
                </div>
            </div>
        </section>

        <section id="plm-enhancement" class="content-section">
            <h2 class="content-section__title">PLM Enhancement & Early-Stage Design Integration</h2>

            <h3 class="content-section__subtitle">Capturing Early Design Intelligence</h3>
            <p>The current repository excels at marketing-ready assets and ERP-linked SKUs, but the front end of the Product Lifecycle Management (PLM) chain‚Äîthe "fuzzy front-end" of ideation, sketches, concept CAD, form-finding videos, supplier quotes, lab results‚Äîis where 80% of downstream decisions are made.</p>

            <h3 class="content-section__subtitle">Extended PLM Directory Structure</h3>
            <p>The PLM directory structure has been extended to include a new '00-Early-Design' folder and its sub-structure within the product hierarchy, ensuring early design intelligence is captured and managed.</p>
            <pre class="code-block">
/DSi-Product-Repository
   /Palace-of-Fragrances
      /Classic-Range
         /Opulent-Shaik-Amethyst
            /00-Early-Design           ‚Üê NEW (Editors: design-only)
               /01-Research
                   /Trend-Reports
                   /Competitive-Benchmarks
                   /Raw-Materials
               /02-Concept-Sketches
                   /Paper-Scans
                   /Procreate
                   /Midjourney-Renders
               /03-Concept-CAD
                   /SolidWorks
                   /Blender
               /04-Design-Review
                   /Stage-Gate-A         ‚Üê PDF deck, budget rough-order
                   /Stage-Gate-B
               /05-Prototype-Assets
                   /3D-Print-STL
                   /Resin-Casts
               /_Archives
            /Media                      ‚Üê Existing structure
            /Marketing
            /ERP-Integration
            </pre>
        </section>

        <section id="implementation" class="content-section">
            <h2 class="content-section__title">Technical Implementation</h2>

            <h3 class="content-section__subtitle">Google Cloud Function Deployment Guide</h3>
            <p>This section details the deployment of a Google Cloud Function to act as a webhook for Google Drive changes, forwarding them to Google Pub/Sub. This function is crucial for triggering real-time media ingestion workflows.</p>

            <h4>requirements.txt</h4>
            <pre class="code-block">
google-cloud-pubsub==2.15.0
google-cloud-storage==2.10.0
            </pre>

            <h4>main.py (Python Code for drive_webhook_to_pubsub)</h4>
            <pre class="code-block">
import os
import base64
from google.cloud import pubsub_v1

PROJECT_ID = os.environ.get("GCP_PROJECT_ID")
TOPIC_ID = os.environ.get("GCP_PUBSUB_TOPIC_ID")

def drive_webhook_to_pubsub(request):
    publisher = pubsub_v1.PublisherClient()
    topic_path = publisher.topic_path(PROJECT_ID, TOPIC_ID)

    # Extract relevant headers from the Drive webhook notification
    headers = dict(request.headers)
    message_data = {
        "X-Goog-Channel-ID": headers.get("X-Goog-Channel-ID"),
        "X-Goog-Channel-Token": headers.get("X-Goog-Channel-Token"),
        "X-Goog-Channel-Expiration": headers.get("X-Goog-Channel-Expiration"),
        "X-Goog-Message-Number": headers.get("X-Goog-Message-Number"),
        "X-Goog-Resource-State": headers.get("X-Goog-Resource-State"),
        "X-Goog-Resource-ID": headers.get("X-Goog-Resource-ID"),
        "X-Goog-Resource-URI": headers.get("X-Goog-Resource-URI"),
        "Content-Type": headers.get("Content-Type"),
        "Content-Length": headers.get("Content-Length"),
        "Body": request.get_data(as_text=True)
    }

    # Convert message_data to a string and then to bytes
    data_str = str(message_data)
    data_bytes = data_str.encode("utf-8")

    # Publish the message to Pub/Sub
    future = publisher.publish(topic_path, data_bytes)
    print(f"Published message ID: {future.result()}")

    return "OK", 200
            </pre>
        </section>

        <section id="deployment" class="content-section">
            <h2 class="content-section__title">Deployment & Hosting Options</h2>

            <div class="cost-comparison">
                <div class="cost-card">
                    <h4 class="cost-card__title">Option A: n8n.cloud + Self-hosted Weaviate</h4>
                    <p class="cost-card__price">~$27/month</p>
                    <ul>
                        <li><strong>Components:</strong> n8n (managed cloud service), Weaviate (VPS deployment), PostgreSQL (VPS deployment)</li>
                        <li><strong>Ideal For:</strong> Quick PoC, low operational overhead</li>
                        <li><strong>Complexity:</strong> Low</li>
                    </ul>
                </div>
                <div class="cost-card">
                    <h4 class="cost-card__title">Option B: Fully Self-hosted</h4>
                    <p class="cost-card__price">~$12/month</p>
                    <ul>
                        <li><strong>Components:</strong> All services on Docker containers, single VPS or local server</li>
                        <li><strong>Ideal For:</strong> Cost-sensitive teams, full control</li>
                        <li><strong>Complexity:</strong> Medium</li>
                    </ul>
                </div>
                <div class="cost-card">
                    <h4 class="cost-card__title">Option C: Kubernetes Cluster</h4>
                    <p class="cost-card__price">~$60+/month</p>
                    <ul>
                        <li><strong>Components:</strong> Helm charts for all services, auto-scaling capabilities, TLS Ingress, Load balancing</li>
                        <li><strong>Ideal For:</strong> Production scale, high availability</li>
                        <li><strong>Complexity:</strong> High</li>
                    </ul>
                </div>
                <div class="cost-card">
                    <h4 class="cost-card__title">Option D: AWS Enterprise</h4>
                    <p class="cost-card__price">~$150-300/month</p>
                    <ul>
                        <li><strong>Components:</strong> ALB (Application Load Balancer), EC2 instances, RDS (managed PostgreSQL), S3 storage, IAM security</li>
                        <li><strong>Ideal For:</strong> Enterprise SLA requirements</li>
                        <li><strong>Complexity:</strong> Very High</li>
                    </ul>
                </div>
            </div>
        </section>

        <section id="testing" class="content-section">
            <h2 class="content-section__title">Testing & Monitoring</h2>

            <h3 class="content-section__subtitle">Enhanced Testing Protocol</h3>
            <div class="mermaid-container">
                <div class="mermaid">
flowchart TB
    Upload["1Ô∏è‚É£ Test Upload<br>Initiate"]
    Queue["2Ô∏è‚É£ Redis Queue<br>Processing"]
    Logs["3Ô∏è‚É£ Verify Logs<br>Execution"]
    Process["4Ô∏è‚É£ Process Validation<br>Workflow"]
    Output["5Ô∏è‚É£ Output Check<br>Results"]
    Monitor["6Ô∏è‚É£ Monitoring Validation<br>Metrics"]
    
    Upload --> Queue
    Queue --> Logs
    Logs --> Process
    Process --> Output
    Output --> Monitor
    
    Upload -.-> UploadDetail["üì§ Upload test image to<br>Product-Images folder"]
    Queue -.-> QueueDetail["üî¥ Verify Redis queue<br>receives message"]
    Logs -.-> LogDetail["üìä Check n8n execution logs<br>for trigger activation"]
    Process -.-> ProcessDetail["‚úÖ Confirm workflow<br>processes file correctly"]
    Output -.-> OutputDetail["üåê Verify Cloudinary URLs in<br>Processed-Media folder"]
    Monitor -.-> MonitorDetail["üìà Check Grafana dashboard<br>for metrics updates"]
    
    style Upload fill:#2563eb,stroke:#1d4ed8,stroke-width:2px,color:#fff
    style Queue fill:#dc2626,stroke:#b91c1c,stroke-width:2px,color:#fff
    style Monitor fill:#16a34a,stroke:#15803d,stroke-width:2px,color:#fff
                </div>
            </div>

            <h3 class="content-section__subtitle">Performance Monitoring Dashboard</h3>
            <div class="note-box">
                <strong>Enhanced Key Metrics to Track:</strong>
                <ul>
                    <li><strong>Queue Performance:</strong> Redis queue length and processing times</li>
                    <li><strong>Database Locks:</strong> PostgreSQL lock wait times and deadlocks</li>
                    <li><strong>Workflow Success Rates:</strong> End-to-end processing success percentage</li>
                    <li><strong>API Response Times:</strong> All external service response metrics</li>
                    <li><strong>Error Recovery:</strong> Retry attempts and DLQ message counts</li>
                    <li><strong>Resource Utilization:</strong> CPU, memory, and storage usage</li>
                    <li><strong>Cost Tracking:</strong> OpenAI API, Cloudinary, and cloud service costs</li>
                    <li><strong>User Activity:</strong> Team engagement and approval response times</li>
                </ul>
            </div>

            <h3 class="content-section__subtitle">End-to-End Testing Scenarios</h3>
            <div class="implementation-steps">
                <h4 class="implementation-steps__title">Enhanced Test Scenario Checklist</h4>
                <div class="step-grid">
                    <div class="step-item" data-step="1">
                        <strong>Queue Management Test</strong>
                        <ul>
                            <li>Verify Redis queue receives messages</li>
                            <li>Test priority-based processing</li>
                            <li>Validate queue durability</li>
                            <li>Check dead letter queue handling</li>
                        </ul>
                    </div>
                    <div class="step-item" data-step="2">
                        <strong>Database Locking Test</strong>
                        <ul>
                            <li>Test concurrent file processing</li>
                            <li>Verify row-level locking</li>
                            <li>Check transaction rollback</li>
                            <li>Validate data consistency</li>
                        </ul>
                    </div>
                    <div class="step-item" data-step="3">
                        <strong>Approval Workflow Test</strong>
                        <ul>
                            <li>Test Forms-based approval</li>
                            <li>Verify Sheets integration</li>
                            <li>Check Chat notifications</li>
                            <li>Validate decision routing</li>
                        </ul>
                    </div>
                    <div class="step-item" data-step="4">
                        <strong>Monitoring & Alerts Test</strong>
                        <ul>
                            <li>Verify Grafana metrics</li>
                            <li>Test alert thresholds</li>
                            <li>Check notification delivery</li>
                            <li>Validate dashboard updates</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="checklist">
                <h4 class="checklist__title">Production Readiness Checklist</h4>
                <div class="checklist__item">
                    <input type="checkbox" id="prod1">
                    <label for="prod1">Redis cluster configured with persistence</label>
                </div>
                <div class="checklist__item">
                    <input type="checkbox" id="prod2">
                    <label for="prod2">PostgreSQL backup and recovery tested</label>
                </div>
                <div class="checklist__item">
                    <input type="checkbox" id="prod3">
                    <label for="prod3">Grafana alerting rules configured</label>
                </div>
                <div class="checklist__item">
                    <input type="checkbox" id="prod4">
                    <label for="prod4">Load testing completed for peak usage</label>
                </div>
                <div class="checklist__item">
                    <input type="checkbox" id="prod5">
                    <label for="prod5">Security audit and penetration testing passed</label>
                </div>
                <div class="checklist__item">
                    <input type="checkbox" id="prod6">
                    <label for="prod6">Disaster recovery procedures documented</label>
                </div>
                <div class="checklist__item">
                    <input type="checkbox" id="prod7">
                    <label for="prod7">Team training completed on new workflows</label>
                </div>
            </div>
        </section>
    </main>

    <footer class="footer">
        <p>¬© 2025 DSI Media Repository Implementation Guide</p>
        <p>This documentation provides complete technical specifications for deploying the DSI Media Repository Integration Architecture with automated workflows from upload to CDN distribution.</p>
        <p>Version 3.0 - Enhanced with Optimized MCP Workflows, Redis Queue Management, Advanced Monitoring, and Production-Ready Architecture</p>
    </footer>

    <button class="back-to-top" id="backToTop" aria-label="Back to top">‚Üë</button>

<script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.6.1/mermaid.min.js"></script>
<script src="script.js"></script>
</body>
</html>
